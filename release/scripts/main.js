/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function n(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:aa(a)}}var p="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ba(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var q=ba(this);function r(a,b){if(b)a:{var c=q;a=a.split(".");for(var f=0;f<a.length-1;f++){var h=a[f];if(!(h in c))break a;c=c[h]}a=a[a.length-1];f=c[a];b=b(f);b!=f&&null!=b&&p(c,a,{configurable:!0,writable:!0,value:b})}}
function u(){this.g=!1;this.b=null;this.i=void 0;this.a=1;this.l=this.f=0;this.c=null}function w(a){if(a.g)throw new TypeError("Generator is already running");a.g=!0}u.prototype.j=function(a){this.i=a};function x(a,b){a.c={D:b,H:!0};a.a=a.f||a.l}u.prototype.return=function(a){this.c={return:a};this.a=this.l};function y(a,b,c){a.a=c;return{value:b}}function ca(a){a.a=0;a.f=0}function da(a){a.f=0;var b=a.c.D;a.c=null;return b}function ea(a){this.a=new u;this.b=a}
function fa(a,b){w(a.a);var c=a.a.b;if(c)return z(a,"return"in c?c["return"]:function(f){return{value:f,done:!0}},b,a.a.return);a.a.return(b);return B(a)}function z(a,b,c,f){try{var h=b.call(a.a.b,c);if(!(h instanceof Object))throw new TypeError("Iterator result "+h+" is not an object");if(!h.done)return a.a.g=!1,h;var m=h.value}catch(e){return a.a.b=null,x(a.a,e),B(a)}a.a.b=null;f.call(a.a,m);return B(a)}
function B(a){for(;a.a.a;)try{var b=a.b(a.a);if(b)return a.a.g=!1,{value:b.value,done:!1}}catch(c){a.a.i=void 0,x(a.a,c)}a.a.g=!1;if(a.a.c){b=a.a.c;a.a.c=null;if(b.H)throw b.D;return{value:b.return,done:!0}}return{value:void 0,done:!0}}
function ha(a){this.next=function(b){w(a.a);a.a.b?b=z(a,a.a.b.next,b,a.a.j):(a.a.j(b),b=B(a));return b};this.throw=function(b){w(a.a);a.a.b?b=z(a,a.a.b["throw"],b,a.a.j):(x(a.a,b),b=B(a));return b};this.return=function(b){return fa(a,b)};this[Symbol.iterator]=function(){return this}}function ia(a){function b(f){return a.next(f)}function c(f){return a.throw(f)}return new Promise(function(f,h){function m(e){e.done?f(e.value):Promise.resolve(e.value).then(b,c).then(m,h)}m(a.next())})}
function C(a){return ia(new ha(new ea(a)))}r("Symbol",function(a){function b(h){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(h||"")+"_"+f++,h)}function c(h,m){this.a=h;p(this,"description",{configurable:!0,writable:!0,value:m})}if(a)return a;c.prototype.toString=function(){return this.a};var f=0;return b});
r("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var f=q[b[c]];"function"===typeof f&&"function"!=typeof f.prototype[a]&&p(f.prototype,a,{configurable:!0,writable:!0,value:function(){return ja(aa(this))}})}return a});function ja(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}
r("Promise",function(a){function b(e){this.b=0;this.c=void 0;this.a=[];this.j=!1;var d=this.f();try{e(d.resolve,d.reject)}catch(g){d.reject(g)}}function c(){this.a=null}function f(e){return e instanceof b?e:new b(function(d){d(e)})}if(a)return a;c.prototype.b=function(e){if(null==this.a){this.a=[];var d=this;this.c(function(){d.g()})}this.a.push(e)};var h=q.setTimeout;c.prototype.c=function(e){h(e,0)};c.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var d=0;d<e.length;++d){var g=
e[d];e[d]=null;try{g()}catch(k){this.f(k)}}}this.a=null};c.prototype.f=function(e){this.c(function(){throw e;})};b.prototype.f=function(){function e(k){return function(l){g||(g=!0,k.call(d,l))}}var d=this,g=!1;return{resolve:e(this.K),reject:e(this.g)}};b.prototype.K=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof b)this.M(e);else{a:switch(typeof e){case "object":var d=null!=e;break a;case "function":d=!0;break a;default:d=!1}d?this.I(e):this.i(e)}};
b.prototype.I=function(e){var d=void 0;try{d=e.then}catch(g){this.g(g);return}"function"==typeof d?this.G(d,e):this.i(e)};b.prototype.g=function(e){this.l(2,e)};b.prototype.i=function(e){this.l(1,e)};b.prototype.l=function(e,d){if(0!=this.b)throw Error("Cannot settle("+e+", "+d+"): Promise already settled in state"+this.b);this.b=e;this.c=d;2===this.b&&this.L();this.A()};b.prototype.L=function(){var e=this;h(function(){if(e.B()){var d=q.console;"undefined"!==typeof d&&d.error(e.c)}},1)};b.prototype.B=
function(){if(this.j)return!1;var e=q.CustomEvent,d=q.Event,g=q.dispatchEvent;if("undefined"===typeof g)return!0;"function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof d?e=new d("unhandledrejection",{cancelable:!0}):(e=q.document.createEvent("CustomEvent"),e.initCustomEvent("unhandledrejection",!1,!0,e));e.promise=this;e.reason=this.c;return g(e)};b.prototype.A=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)m.b(this.a[e]);this.a=null}};var m=new c;b.prototype.M=
function(e){var d=this.f();e.v(d.resolve,d.reject)};b.prototype.G=function(e,d){var g=this.f();try{e.call(d,g.resolve,g.reject)}catch(k){g.reject(k)}};b.prototype.then=function(e,d){function g(v,A){return"function"==typeof v?function(V){try{k(v(V))}catch(W){l(W)}}:A}var k,l,t=new b(function(v,A){k=v;l=A});this.v(g(e,k),g(d,l));return t};b.prototype.catch=function(e){return this.then(void 0,e)};b.prototype.v=function(e,d){function g(){switch(k.b){case 1:e(k.c);break;case 2:d(k.c);break;default:throw Error("Unexpected state: "+
k.b);}}var k=this;null==this.a?m.b(g):this.a.push(g);this.j=!0};b.resolve=f;b.reject=function(e){return new b(function(d,g){g(e)})};b.race=function(e){return new b(function(d,g){for(var k=n(e),l=k.next();!l.done;l=k.next())f(l.value).v(d,g)})};b.all=function(e){var d=n(e),g=d.next();return g.done?f([]):new b(function(k,l){function t(V){return function(W){v[V]=W;A--;0==A&&k(v)}}var v=[],A=0;do v.push(void 0),A++,f(g.value).v(t(v.length-1),l),g=d.next();while(!g.done)})};return b});
function D(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""}r("String.prototype.repeat",function(a){return a?a:function(b){var c=D(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var f="";b;)if(b&1&&(f+=c),b>>>=1)c+=c;return f}});
r("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}});r("Array.prototype.includes",function(a){return a?a:function(b,c){var f=this;f instanceof String&&(f=String(f));var h=f.length;c=c||0;for(0>c&&(c=Math.max(c+h,0));c<h;c++){var m=f[c];if(m===b||Object.is(m,b))return!0}return!1}});r("String.prototype.includes",function(a){return a?a:function(b,c){return-1!==D(this,b,"includes").indexOf(b,c||0)}});
r("String.prototype.startsWith",function(a){return a?a:function(b,c){var f=D(this,b,"startsWith"),h=f.length,m=b.length;c=Math.max(0,Math.min(c|0,f.length));for(var e=0;e<m&&c<h;)if(f[c++]!=b[e++])return!1;return e>=m}});function E(a,b){return Object.prototype.hasOwnProperty.call(a,b)}
r("WeakMap",function(a){function b(g){this.a=(d+=Math.random()+1).toString();if(g){g=n(g);for(var k;!(k=g.next()).done;)k=k.value,this.set(k[0],k[1])}}function c(){}function f(g){var k=typeof g;return"object"===k&&null!==g||"function"===k}function h(g){if(!E(g,e)){var k=new c;p(g,e,{value:k})}}function m(g){var k=Object[g];k&&(Object[g]=function(l){if(l instanceof c)return l;Object.isExtensible(l)&&h(l);return k(l)})}if(function(){if(!a||!Object.seal)return!1;try{var g=Object.seal({}),k=Object.seal({}),
l=new a([[g,2],[k,3]]);if(2!=l.get(g)||3!=l.get(k))return!1;l.delete(g);l.set(k,4);return!l.has(g)&&4==l.get(k)}catch(t){return!1}}())return a;var e="$jscomp_hidden_"+Math.random();m("freeze");m("preventExtensions");m("seal");var d=0;b.prototype.set=function(g,k){if(!f(g))throw Error("Invalid WeakMap key");h(g);if(!E(g,e))throw Error("WeakMap key fail: "+g);g[e][this.a]=k;return this};b.prototype.get=function(g){return f(g)&&E(g,e)?g[e][this.a]:void 0};b.prototype.has=function(g){return f(g)&&E(g,
e)&&E(g[e],this.a)};b.prototype.delete=function(g){return f(g)&&E(g,e)&&E(g[e],this.a)?delete g[e][this.a]:!1};return b});
r("Map",function(a){function b(){var d={};return d.m=d.next=d.head=d}function c(d,g){var k=d.a;return ja(function(){if(k){for(;k.head!=d.a;)k=k.m;for(;k.next!=k.head;)return k=k.next,{done:!1,value:g(k)};k=null}return{done:!0,value:void 0}})}function f(d,g){var k=g&&typeof g;"object"==k||"function"==k?m.has(g)?k=m.get(g):(k=""+ ++e,m.set(g,k)):k="p_"+g;var l=d.b[k];if(l&&E(d.b,k))for(d=0;d<l.length;d++){var t=l[d];if(g!==g&&t.key!==t.key||g===t.key)return{id:k,list:l,index:d,h:t}}return{id:k,list:l,
index:-1,h:void 0}}function h(d){this.b={};this.a=b();this.size=0;if(d){d=n(d);for(var g;!(g=d.next()).done;)g=g.value,this.set(g[0],g[1])}}if(function(){if(!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),g=new a(n([[d,"s"]]));if("s"!=g.get(d)||1!=g.size||g.get({x:4})||g.set({x:4},"t")!=g||2!=g.size)return!1;var k=g.entries(),l=k.next();if(l.done||l.value[0]!=d||"s"!=l.value[1])return!1;l=k.next();return l.done||4!=l.value[0].x||
"t"!=l.value[1]||!k.next().done?!1:!0}catch(t){return!1}}())return a;var m=new WeakMap;h.prototype.set=function(d,g){d=0===d?0:d;var k=f(this,d);k.list||(k.list=this.b[k.id]=[]);k.h?k.h.value=g:(k.h={next:this.a,m:this.a.m,head:this.a,key:d,value:g},k.list.push(k.h),this.a.m.next=k.h,this.a.m=k.h,this.size++);return this};h.prototype.delete=function(d){d=f(this,d);return d.h&&d.list?(d.list.splice(d.index,1),d.list.length||delete this.b[d.id],d.h.m.next=d.h.next,d.h.next.m=d.h.m,d.h.head=null,this.size--,
!0):!1};h.prototype.clear=function(){this.b={};this.a=this.a.m=b();this.size=0};h.prototype.has=function(d){return!!f(this,d).h};h.prototype.get=function(d){return(d=f(this,d).h)&&d.value};h.prototype.entries=function(){return c(this,function(d){return[d.key,d.value]})};h.prototype.keys=function(){return c(this,function(d){return d.key})};h.prototype.values=function(){return c(this,function(d){return d.value})};h.prototype.forEach=function(d,g){for(var k=this.entries(),l;!(l=k.next()).done;)l=l.value,
d.call(g,l[1],l[0],this)};h.prototype[Symbol.iterator]=h.prototype.entries;var e=0;return h});function ka(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var f=c.slice();f.push.apply(f,arguments);return a.apply(this,f)}};function la(){var a=F;window.firebase.firestore().collection("configuration").orderBy("timestamp","desc").limit(1).onSnapshot(function(b){if(0<b.size){b=b.docs[0].data();a.j=b.hasOwnProperty("enabled")?b.enabled:a.j;a.l=b.hasOwnProperty("event_start")?b.event_start:a.l;a.g=b.hasOwnProperty("fallback_url")?b.fallback_url:a.g;a.a=b.hasOwnProperty("config")?b.callback_window_ms:a.a;a.b=b.hasOwnProperty("callback_threshold")?b.callback_threshold:a.b;a.i=b.hasOwnProperty("admin_users")?b.admin_users:a.i;
a.f=b.hasOwnProperty("youtube_video")?b.youtube_video:a.f;a.c=b.hasOwnProperty("youtube_chat")?b.youtube_chat:a.c;b=n(a.A);for(var c=b.next();!c.done;c=b.next())c=c.value,c(a)}},function(b){console.error("Error querying Firestore: ",b)})}var F=new function(){this.j=!1;this.l=null;this.B=!1;this.g="";this.a=1E4;this.b=3;this.c=this.f="";this.i=[];this.A=[]};function ma(a,b,c){c=c||na;for(var f=0,h=a.length,m;f<h;){var e=f+(h-f>>>1);var d=c(b,a[e]);0<d?f=e+1:(h=e,m=!d)}return m?f:-f-1}function na(a,b){return a>b?1:a<b?-1:0};function oa(){this.text="callback-message-";this.index=0}oa.prototype.next=function(){return this.text+this.index++};function G(a){try{var b=new URL(a);/(.*\.)?googleusercontent\.com$/.test(b.hostname)&&b.searchParams.set("sz","150");return b.toString()}catch(c){if(c instanceof TypeError)return a;throw c;}}
function pa(a){var b=H().querySelectorAll(".message-container");if(0===b.length)return null;a=ma(b,a,function(c,f){var h=parseInt(f.getAttribute("timestamp"),10);if(!h)throw Error("Child "+f.id+" has no 'timestamp' attribute");return c-h});return a>=b.length||a<-b.length?null:0<=a?b[a+1]:b[-(a+1)]}
function qa(a){a[0].isIntersecting?(H().dataset.C=!0,document.getElementById("scroll-down-container").setAttribute("hidden",!0)):(delete H().dataset.C,0<H().querySelectorAll(".message").length&&document.getElementById("scroll-down-container").removeAttribute("hidden"))}function I(){return document.getElementById("outer-container")}function J(){return document.getElementById("promo")}function K(){return document.getElementById("error-container")}
function L(){return document.getElementById("intro-container")}function H(){return document.getElementById("messages")}function M(){return document.getElementById("last-message")}function N(){return document.getElementById("message")}function O(){return document.getElementById("user-name")}function ra(){return document.getElementById("messages-card-container")}function sa(){return document.getElementById("youtube-stream-container")}function P(){return document.getElementById("youtube-video")}
function Q(){return document.getElementById("youtube-chat")}function ta(){return document.getElementById("hidden-audio")};function R(a,b,c,f,h){this.text=a;this.c=b;this.b=c;this.F=f;this.a=h;Date.now()}function ua(a){a.a()&&a.a().removeAttribute("disabled")}function va(a){return"\ud83d\udc4f"===a.text||"\ud83d\udc4e"===a.text?a.text.repeat(S(3,6)):a.text+"!".repeat(S(1,3))+"1".repeat(S(0,2))+"!".repeat(S(1,2))}function wa(a){return"\ud83d\udc4f"===a.text||"\ud83d\udc4e"===a.text?a.text:a.text+"!!"}function T(a){return"\ud83d\udc4f"===a.text?"APPLAUSE":"\ud83d\udc4e"===a.text?"BOO":a.text}
function S(a,b){return a+Math.floor(Math.random()*(b-a+1))}
var U=[new R("SCIENCE","\ud83d\udd2c","science1.mp4 science2.mp4 science3.mp4 science4.mp4 science5.mp4 science6.mp4 science7.mp4".split(" "),function(){return document.getElementById("science-form")},function(){return document.getElementById("science")}),new R("ART","\ud83c\udfa8",["art1.mp4","art2.mp4","art3.mp4"],function(){return document.getElementById("art-form")},function(){return document.getElementById("art")}),new R("MAPS","\ud83d\uddfa\ufe0f",["maps1.mp4","maps2.mp4","maps3.mp4"],function(){return document.getElementById("maps-form")},
function(){return document.getElementById("maps")}),new R("SHIPS","\ud83d\udea2","ships1.mp4 ships2.mp4 ships3.mp4 ships4.mp4 ships5.mp4 ships6.mp4".split(" "),function(){return document.getElementById("ships-form")},function(){return document.getElementById("ships")}),new R("\ud83d\udc4f","\ud83d\udc4f",["applause1.mp4","applause2.mp4","applause3.mp4"],function(){return document.getElementById("applause-form")},function(){return document.getElementById("applause")}),new R("\ud83d\udc4e","\ud83d\udc4e",
["boo1.mp4","boo2.mp4","boo3.mp4"],function(){return document.getElementById("boo-form")},function(){return document.getElementById("boo")}),new R("STEEN","\ud83c\udf99\ufe0f",["steen1.mp4","steen2.mp4","steen3.mp4"],function(){return document.getElementById("steen-form")},function(){return document.getElementById("steen")})];function X(a,b){window.firebase.analytics instanceof Function&&window.firebase.analytics().logEvent(a,b)};function xa(){var a,b;C(function(c){if(1==c.a)return c.f=2,y(c,window.firebase.messaging().getToken(),4);if(2!=c.a)return(a=c.i)?window.firebase.firestore().collection("fcmTokens").doc(a).set({uid:window.firebase.auth().currentUser.uid,timestamp:window.firebase.firestore.FieldValue.serverTimestamp()}):ya(),ca(c);b=da(c);console.error("Unable to get messaging token.",b);c.a=0})}
function za(){var a,b;C(function(c){if(1==c.a)return c.f=2,y(c,window.firebase.messaging().getToken(),4);if(2!=c.a)return(a=c.i)&&window.firebase.firestore().collection("fcmTokens").doc(a).delete().catch(function(f){console.error("Error removing token: ",f)}),ca(c);b=da(c);console.error("Unable to get messaging token.",b);c.a=0})}function ya(){Notification.requestPermission().then(function(){xa()}).catch(function(a){console.error("Unable to get permission to notify.",a)})};function Y(){return window.firebase.auth().currentUser.uid}function Aa(){return window.firebase.auth().currentUser.photoURL||"/images/profile_placeholder.png"};function Ba(){document.getElementById("message-form")&&document.getElementById("message-form").addEventListener("submit",Ca);document.getElementById("sign-out").addEventListener("click",Da);document.getElementById("sign-in").addEventListener("click",Ea);document.getElementById("sign-in-splash").addEventListener("click",Ea);document.getElementById("notifications-switch")&&document.getElementById("notifications-switch").addEventListener("click",function(c){c.target.checked?xa():za()});for(var a=n(U),
b=a.next();!b.done;b=a.next())b=b.value,b.F()&&b.F().addEventListener("submit",ka(Fa,b));N()&&(N().addEventListener("keyup",Ga),N().addEventListener("change",Ga));M()&&((new window.IntersectionObserver(qa,{root:H(),rootMargin:"0px",threshold:.1})).observe(M()),document.getElementById("scroll-down-form")&&document.getElementById("scroll-down-form").addEventListener("submit",function(c){c.preventDefault();M().scrollIntoView(!1)}))}
function Ea(){var a=new firebase.auth.GoogleAuthProvider;firebase.auth().signInWithPopup(a);X("login",{method:""})}function Da(){firebase.auth().signOut()}function Ha(a){U.forEach(function(b){a===wa(b)&&window.firebase.firestore().collection(T(b)).doc(Y()).set({profilePicUrl:Aa(),timestamp:window.firebase.firestore.FieldValue.serverTimestamp()}).catch(function(c){console.error("Error writing new message to database",c)})})}
function Ia(a){Ha(a);return window.firebase.firestore().collection("messages").add({uid:Y(),name:window.firebase.auth().currentUser.displayName,text:a,profilePicUrl:Aa(),timestamp:window.firebase.firestore.FieldValue.serverTimestamp()}).catch(function(b){console.error("Error writing new message to database",b)})}function Ca(a){return C(function(b){a.preventDefault();X("share",{method:"chat",content_type:"freeform",content_id:""});return y(b,Ja(N().value),0)})}
function Fa(a,b){return C(function(c){if(1==c.a)return b.preventDefault(),X("share",{method:"chat",content_type:T(a),content_id:""}),y(c,Ja(wa(a)),2);a.a().setAttribute("disabled","true");setTimeout(function(){return ua(a)},1E3);c.a=0})}
function Ja(a){return C(function(b){if(1==b.a){var c;if(c=a)window.firebase.auth().currentUser?c=!0:(document.getElementById("must-signin-snackbar").MaterialSnackbar.showSnackbar({message:"You must sign-in first",timeout:2E3}),c=!1);c?b=y(b,Ia(a),3):(b.a=0,b=void 0);return b}c=N();c.value="";c.parentNode.MaterialTextfield&&c.parentNode.MaterialTextfield.boundUpdateClassesHandler();Ga();b.a=0})}
function Ga(){N().value?document.getElementById("submit").removeAttribute("disabled"):document.getElementById("submit").setAttribute("disabled","true")};var Ka=U.map(function(a){return wa(a)});function La(a,b,c,f,h,m,e){this.id=a;this.timestamp=b;this.f=c;this.c=f;this.a=h;this.text=m;this.b=e;this.g=new Autolinker({N:!0,O:!1,P:!1})}La.prototype.remove=function(){var a=document.getElementById(this.id);a&&a.parentNode.removeChild(a)};
function Ma(a){if(!Ka.includes(a.text)){var b=pa(Na(a)),c=H().dataset.C||null===b&&a.f===Y(),f=document.getElementById(a.id)||Oa(a,b);a.a&&(f.querySelector(".pic").style.backgroundImage="url("+G(a.a)+")");f.querySelector(".name").textContent=a.c;a.timestamp&&1E4<a.timestamp.getTime()&&(f.querySelector(".timestamp").textContent=a.timestamp.toLocaleDateString()+" "+a.timestamp.toLocaleTimeString());b=f.querySelector(".message");if(F.i.includes(Y())&&!a.id.startsWith("callback-message-")&&!f.querySelector(".admin")){var h=
document.createElement("a");h.className="admin";h.setAttribute("href","#");h.textContent="delete";h.addEventListener("click",function(){firebase.firestore().collection("messages").doc(a.id).delete().catch(function(d){console.error("Error removing message: ",d)})});var m=f.querySelector(".byline");m.insertBefore(h,m.childNodes[0])}if(a.text)b.textContent=a.text,b.innerHTML=DOMPurify.sanitize(b.innerHTML),b.innerHTML=a.g.link(b.innerHTML),b.innerHTML=b.innerHTML.replace(/\n/g,"<br>");else if(a.b){h=
document.createElement("video");h.a=!0;h.autoplay=!0;h.muted=!0;h.className="callback-video";m=document.createElement("source");m.src=a.b;m.type="video/mp4";var e=document.createTextNode("Your browser does not support the video tag.");h.innerHTML="";h.appendChild(m);h.appendChild(e);h.onloadedmetadata=function(){c&&M().scrollIntoView(!1)};b.innerHTML="";b.appendChild(h)}setTimeout(function(){f.classList.add("visible")},1);c&&M().scrollIntoView(!1);N()&&N().focus()}}
function Oa(a,b){var c=document.createElement("div");c.innerHTML='<div class="message-container"><div class="spacing"><div class="pic"></div></div><div class="message"></div><div class="byline"><div class="timestamp"></div><div class="name"></div></div></div>';c=c.firstChild;c.setAttribute("id",a.id);c.setAttribute("timestamp",Na(a));b||(b=M());H().insertBefore(c,b);return c}function Na(a){a.timestamp||(a.timestamp=new Date);return a.timestamp.getTime()}var Pa=new Map,Z=[];
function Qa(a){a.docChanges&&(a.docChanges().forEach(function(b){if("removed"===b.type)Pa.get(b.doc.id).remove();else{var c=b.doc.data(),f=c.timestamp?c.timestamp.toDate():null;b=b.doc.id;c=new La(b,f,c.uid,c.name,c.profilePicUrl,c.text,c.videoUrl);Pa.set(b,c);Ma(c)}}),a.empty||Z.push(a.query.startAfter(a.docs[a.size-1]).onSnapshot(Qa,Ra)))}function Ra(a){console.error("Error querying Firestore: ",a)}function Sa(){for(var a=n(Z),b=a.next();!b.done;b=a.next())b=b.value,b();Z=[]};function Ta(a){this.o=a;this.b=Date.now()-F.a;this.a=this.u=null}function Ua(a){a.o.b.forEach(function(b){var c=document.createElement("audio");c.id=b;c.b=!0;c.hidden=!0;c.preload="auto";c.src="video/"+b;ta().appendChild(c)})}
function Va(a,b){if(b){var c=Math.max(a.b,Date.now()-F.a),f=b.filter(function(h){return Wa(h.data())>c});0<f.length&&(b=Wa(b[0].data()),0<b&&(f.length>=F.b?(a.a&&(a.a.a.remove(),a.a=null),a.b=b+1E3,Xa(a,b+1),X("screen_view",{screen_name:T(a.o)})):(f=f.map(function(h){return{uid:h.id,J:h.data().profilePicUrl}}),Ya(a,b,f,c))))}}
function Ya(a,b,c,f){if(!a.a||a.a.timestamp<f)a.a=new Za(a.o.c,va(a.o),b),$a(a.a);b=n(c);for(c=b.next();!c.done;c=b.next()){var h=c.value;c=a.a;f=h.uid;h=h.J;if(!c.b.includes(f)){c.b.push(f);var m=c.a.querySelector(".callback-progress-bar");m.style.width=100*c.b.length/F.b+"%";var e=document.createElement("div");e.className="callback-progress-voice";h&&(e.style.backgroundImage="url("+G(h)+")");m.insertBefore(e,c.a.querySelector(".callback-progress-callback"));(H().dataset.C||f===Y())&&M().scrollIntoView(!1)}}}
function Xa(a,b){var c=a.o.b[Math.floor(Math.random()*a.o.b.length)],f=ab.next();b=new Date(b);a=va(a.o);a=new La(f,b,"",a,"images/adventureharvey.jpg","","video/"+c);Pa.set(f,a);Ma(a);document.getElementById(c).play()}var ab=new oa;function Za(a,b,c){this.id=ab.next();this.c=a;this.f=b;this.timestamp=c;this.a=null;this.b=[]}
function $a(a){if(!document.getElementById(a.id)){var b=document.createElement("div");b.innerHTML='<div class="message-container">  <div class="spacing"><div class="callback-emoji"></div></div>  <div class="callback-progress">    <div class="callback-progress-bar">      <div class="callback-progress-callback"></div>    </div>  </div></div>';a.a=b.firstChild;a.a.setAttribute("id",a.id);a.a.setAttribute("timestamp",a.timestamp);a.a.querySelector(".callback-emoji").innerText=a.c;a.a.querySelector(".callback-progress-callback").innerText=
a.f;(b=pa(a.timestamp))||(b=M());H().insertBefore(a.a,b);setTimeout(function(){a.a.classList.add("visible")},1);setTimeout(function(){var c=a.a.querySelector(".callback-progress-bar");c.style.transition="opacity "+(F.a-1E3)+"ms ease-in";c.style.opacity=0},1001);setTimeout(function(){var c=a.a.querySelector(".callback-progress-bar");c.classList.remove("callback-progress-bar");c.classList.add("callback-progress-bar-expired");c.removeAttribute("style")},F.a)}H().dataset.C&&M().scrollIntoView(!1)}
function Wa(a){return a&&a.timestamp&&a.timestamp.toMillis?a.timestamp.toMillis():-1}var bb=U.map(function(a){return new Ta(a)});function cb(a){a.j?a.g&&document.getElementById("error-link")?(K().removeAttribute("hidden"),I().setAttribute("hidden",!0),J().setAttribute("hidden",!0),document.getElementById("error-link").setAttribute("href",a.g),X("screen_view",{screen_name:"error"})):(I().hasAttribute("hidden")&&(I().removeAttribute("hidden"),J()&&J().setAttribute("hidden",!0),K()&&K().setAttribute("hidden",!0),X("screen_view",{screen_name:"main"})),P()&&(a.f?(P().src="https://www.youtube.com/embed/"+a.f,P().removeAttribute("hidden")):
P().setAttribute("hidden",!0)),Q()&&(a.c?(Q().src="https://www.youtube.com/live_chat?v="+a.c+("&embed_domain="+window.location.hostname),Q().removeAttribute("hidden")):Q().setAttribute("hidden",!0)),sa()&&(a.f||a.c?sa().removeAttribute("hidden"):sa().setAttribute("hidden",!0)),db()):J()&&(J().removeAttribute("hidden"),I().setAttribute("hidden",!0),K().setAttribute("hidden",!0),X("screen_view",{screen_name:"promo"}))}
function eb(a){var b,c,f,h,m;return C(function(e){if(1==e.a){if(!a){O().setAttribute("hidden","true");document.getElementById("user-pic").setAttribute("hidden","true");document.getElementById("kebab-menu").setAttribute("hidden","true");document.getElementById("sign-in").removeAttribute("hidden");document.getElementById("signin-splashscreen").removeAttribute("hidden");ra().setAttribute("hidden","true");b=n(bb);for(c=b.next();!c.done;c=b.next())f=c.value,f.u&&(f.u(),f.u=null);Sa();e.a=0;return}h=Aa();
m=window.firebase.auth().currentUser.displayName;document.getElementById("user-pic").style.backgroundImage="url("+G(h)+")";O().textContent=m;O().removeAttribute("hidden");document.getElementById("user-pic").removeAttribute("hidden");document.getElementById("kebab-menu").removeAttribute("hidden");document.getElementById("sign-in").setAttribute("hidden","true");document.getElementById("signin-splashscreen").setAttribute("hidden","true");xa();ta().innerHTML="";bb.forEach(function(d){return Ua(d)});cb(F);
if(F.B||!L()){fb();e.a=0;return}return y(e,gb(),4)}fb();e.a=0})}function fb(){ra().removeAttribute("hidden");L()&&L().setAttribute("hidden",!0);N()&&(N().removeAttribute("disabled"),N().focus());var a=F.l,b=firebase.firestore().collection("messages").limit(12);a&&(b=b.where("timestamp",">",a));b=b.orderBy("timestamp","desc");0==Z.length&&Z.push(b.onSnapshot(Qa,Ra));X("screen_view",{screen_name:"chat"})}
function gb(){L().removeAttribute("hidden");ra().setAttribute("hidden",!0);X("screen_view",{screen_name:"introduction"});return new Promise(function(a){document.getElementById("intro-button").addEventListener("click",function(){ta().querySelectorAll("audio").forEach(function(b){b.volume=0;b.muted=!0;b.playbackRate=2;b.onended=function(){b.volume=1;b.muted=!1;b.playbackRate=1;b.onended=null};b.play()});U.forEach(function(b){return ua(b)});F.B=!0;a()})})}
function db(){for(var a={},b=n(bb),c=b.next();!c.done;a={s:a.s},c=b.next())a.s=c.value,a.s.u&&a.s.u(),c=window.firebase.firestore().collection(T(a.s.o)).orderBy("timestamp","desc").limit(F.b),a.s.u=c.onSnapshot(function(f){return function(h){Va(f.s,h.docs)}}(a),function(f){console.error("Error querying Firestore: ",f)})};window.firebase&&firebase.app instanceof Function&&firebase.app().options?(firebase.performance(),firebase.analytics(),Ba(),firebase.auth().onAuthStateChanged(eb),F.A.push(cb),la()):window.alert("You have not configured and imported the Firebase SDK. Make sure you go through the codelab setup instructions and make sure you are running the codelab using `firebase serve`");
